{"year": "2019", "forum": "SkloDjAqYm", "title": "LeMoNADe: Learned Motif and Neuronal Assembly Detection in calcium imaging videos", "decision": "Accept (Poster)", "meta_review": "This paper is about representation learning for calcium imaging and thus a bit different in scope that most ICLR submissions. But the paper is well-executed with good choices for the various parts of the model making it relevant for other similar domains.", "reviews": [{"review_id": "SkloDjAqYm-0", "review_text": "The paper proposes a VAE-style model for identifying motifs from calcium imaging videos. As opposed to standard VAE with Gaussian latent variables it relies on Bernouli variables and hence, requires Gumbel-softmax trick for inference. Compared to methods based on matrix factorization, the proposed method has the advantage of not requiring any preprocessing on the imaging videos. My main comments are as follows: - How sensitive is the method to the choice of beta and other hyperparameters? Compared to SCC which has fewer hyperparameters, how robust is the method? - How does it perform on real data compared to methods based on spike time matrices? Do they generate similar motifs? - The application of the method seems quite limited to calcium imaging videos and it does not provide comparison with other deep generative models for videos. Methods such as Johnson et al. NIPS 2016 (Composing graphical models with neural networks for structured representations and fast inference) can also be applied to calcium imaging datasets and can potentially infer the motifs. I believe the problem of inferring the neural motifs is an interesting problem; however, I think this paper requires more work to it shows its advantages over other deep generative models for video data and also it\u2019s performance on real data compared to SCC (or some other matrix factorization based approach). ----------------------------------------------------------------------- The authors have addressed my comments about other deep generative models and hyperparameter sensitivity. However, I still think the paper is more suitable for other venues with readers from the neuroscience community. Hence, I change my rating to 5. ", "rating": "5: Marginally below acceptance threshold", "reply_text": "We appreciate the reviewers comments and will address them in the following and in the revised version of the manuscript which is already uploaded . Sensitivity to parameters : The main parameters that need to be chosen for each dataset individually are the maximum number of motifs and the maximum motif length . In appendix E.1 and E.2 we show the effects of over- and under-estimating these numbers for LeMoNADe and that they can be set to quite liberal values . Additionally , one of the sparsity parameters beta or \u00e2 has to be adapted to the dataset . In appendix E.3 of the revised version we provide examples of different settings of \u00e2 and beta , showing that they are complementary . This leaves us with three parameters that have to be adapted to a new dataset . For SCC also three parameters have to be chosen : number of motifs , motif length , penalty on l_1 norm of the assemblies = sparsity parameter . The examples in appendix E.3 also indicate that LeMoNADe 's results are robust to small variations of \u00e2 and beta and the results only change significantly when the parameters are varied by more than one order of magnitude . Peter et al.describe a similar sensitivity of SCC to the variation of their sparsity parameter . Other hyper parameters of LeMoNADe ( e.g.temperatures of the BinConcrete relaxation , learning rate ) do not need to be adapted to different datasets . We found that our default settings worked well for different kinds of data . Results on real data compared to SCC results : In appendix D.3 of the revised version we now show the results obtained with SCC on calcium traces of manually extracted ROIs from one of the datasets discussed in the paper . We also show , using traces extracted from the motif identified with LeMoNADe on the original dataset , that SCC and LeMoNADe find highly similar motifs on real data . Other generative models : As we mention in the related work section , a few deep generative models exist dealing with video data . However , to the best of our knowledge , none of these models is directly applicable to the task of detecting motifs with temporal structure in calcium imaging data . Indeed , Johnson et al.present an interesting generative model for the analysis of video data . However , we consider this model as not being able to identify motifs with temporal structure from calcium imaging data due to two limitations ( for the detection of motifs in calcium videos ) of the model by Johnson et al . : 1.Neuronal assemblies are expected to extend over multiple frames ( depending on the frame rate of the recording this could be easily more than 20 frames ) . Since in Johnson et al . 's model the underlying latent process is a relatively simple first-order Markovian ( switching ) linear process , representing longer-term temporal dependencies will be very hard to achieve due to the usually exponential forgetting in such systems . In fact , Johnson et al . 's framework would need to be significantly extended , e.g.using LSTM units , to adapt their model for this task , which is a non-trivial task and could be considered to be a paper in its own right . 2.In the model of Johnson et al.each frame is generated from exactly one of K latent states . For calcium imaging , however , most frames are not generated by one of the motifs but from noise . While LeMoNADe has the chance to set the latent variables for noise frames simply to zero , Johnson et al . 's model would have to choose one motif as responsible for the frame even if it contains only noise . Moreover , LeMoNADe has the flexibility to also allow the different motifs to temporally overlap . This is also not possible in the model by Johnson et al. , since they allow always only exactly one latent state for each frame . For this reason , we can not compare to Johnson et al.on the task of detecting motifs in calcium imaging data . In the revised version of the manuscript we extended our citation of Johnson et al.with a short explanation why the model is not directly applicable to our setup of motif detection from calcium imaging data . The application is limited to calcium imaging data : The model and network architectures are indeed optimised for the task of detecting motifs in calcium imaging data . This is , however , no downside of the method . Calcium imaging is a method of first importance in neurophysiology . It allows the concurrent monitoring of the individual actions of thousands of neurons at the same time . As explained above , no other method is directly applicable to finding temporal motifs in calcium imaging data and in order to do so we had to adapt our method to the special properties of calcium imaging and neuronal assemblies . Nevertheless , our approach could also be adapted for detecting spatio-temporal motifs in data from other imaging techniques , such as voltage-sensitive dyes or functional magnetic resonance imaging ( fMRI ) ."}, {"review_id": "SkloDjAqYm-1", "review_text": "Thank you for a pleasurable and informative read, I consider the writing and structure of the paper to be coherent and well written. Given an end-to-end learning of neural motifs, a great deal of time can be avoided, reducing the several intermediary steps required to detect motifs from calcium imaging. This paper may very well improve researchers efficiency, in particular when working with calcium imaging. The question remain to what extent these ideas may be useful in other imaging modalities, i.e. fMRI. My main critique would be to be more explicit about why the VAE you propose, is superior to other models in the generative modelling domain.", "rating": "8: Top 50% of accepted papers, clear accept", "reply_text": "We are gratefull for AnonReviewer4 's extra effort in order to provide us with a third review . We also thank him/her for the positive comments and for considering our paper to be well written and structured , and improving researchers efficiency . We agree that the application to fMRI and other imaging modalities makes for interesting future work . We took the reviewers comment into account and added a remark in the revised version at the beginning of section 3 . The great benefit of this generative model in combination with the proposed VAE is the possibility to directly extract the temporal motifs and their activations and at the same time take into account the sparse nature of neuronal assemblies ."}, {"review_id": "SkloDjAqYm-2", "review_text": "last time i had two comments: 1. the real data motifs did not look like what i'd expect motifs to look like. now that the authors have thresholded the real data motifs, they do look as i'd expect. 2. i'm not a fan of VAE, and believe that simpler optimization algorithms might be profitable. i acknowledge that SCC requires additional steps; i am not comparing to SCC. rather, i'm saying given your generative model, there are many strategies one could employ to estimate the motifs. i realize that VAE is all the rage, and is probably fine. in my own experiments, simpler methods often work as well or better for these types of problems. i therefore believe this would be an interesting avenue to explore in future work.", "rating": "8: Top 50% of accepted papers, clear accept", "reply_text": "We kindly thank the reviewer for his/her positive feedback . We would appreciate it if you could state again - as you did in your last review - why the problem we address is an important one and why quote `` having an end-to-end procedure to learn motifs would be awesome '' . : ) Of course there are different approaches in general to infer generative models . However , given our particular generative model our approach to do inference via VI in the form of a VAE is rather intuitive and stable compared to e.g.sampling based approaches which are computationally more expensive or EM based approaches which are usually less flexible . So we are not using VAEs just because they are all the rage right now ( then we would use a GAN anyway ; ) ) . Nevertheless , we will of course continue doing research on this topic and will also investigate other approaches in future work ."}], "0": {"review_id": "SkloDjAqYm-0", "review_text": "The paper proposes a VAE-style model for identifying motifs from calcium imaging videos. As opposed to standard VAE with Gaussian latent variables it relies on Bernouli variables and hence, requires Gumbel-softmax trick for inference. Compared to methods based on matrix factorization, the proposed method has the advantage of not requiring any preprocessing on the imaging videos. My main comments are as follows: - How sensitive is the method to the choice of beta and other hyperparameters? Compared to SCC which has fewer hyperparameters, how robust is the method? - How does it perform on real data compared to methods based on spike time matrices? Do they generate similar motifs? - The application of the method seems quite limited to calcium imaging videos and it does not provide comparison with other deep generative models for videos. Methods such as Johnson et al. NIPS 2016 (Composing graphical models with neural networks for structured representations and fast inference) can also be applied to calcium imaging datasets and can potentially infer the motifs. I believe the problem of inferring the neural motifs is an interesting problem; however, I think this paper requires more work to it shows its advantages over other deep generative models for video data and also it\u2019s performance on real data compared to SCC (or some other matrix factorization based approach). ----------------------------------------------------------------------- The authors have addressed my comments about other deep generative models and hyperparameter sensitivity. However, I still think the paper is more suitable for other venues with readers from the neuroscience community. Hence, I change my rating to 5. ", "rating": "5: Marginally below acceptance threshold", "reply_text": "We appreciate the reviewers comments and will address them in the following and in the revised version of the manuscript which is already uploaded . Sensitivity to parameters : The main parameters that need to be chosen for each dataset individually are the maximum number of motifs and the maximum motif length . In appendix E.1 and E.2 we show the effects of over- and under-estimating these numbers for LeMoNADe and that they can be set to quite liberal values . Additionally , one of the sparsity parameters beta or \u00e2 has to be adapted to the dataset . In appendix E.3 of the revised version we provide examples of different settings of \u00e2 and beta , showing that they are complementary . This leaves us with three parameters that have to be adapted to a new dataset . For SCC also three parameters have to be chosen : number of motifs , motif length , penalty on l_1 norm of the assemblies = sparsity parameter . The examples in appendix E.3 also indicate that LeMoNADe 's results are robust to small variations of \u00e2 and beta and the results only change significantly when the parameters are varied by more than one order of magnitude . Peter et al.describe a similar sensitivity of SCC to the variation of their sparsity parameter . Other hyper parameters of LeMoNADe ( e.g.temperatures of the BinConcrete relaxation , learning rate ) do not need to be adapted to different datasets . We found that our default settings worked well for different kinds of data . Results on real data compared to SCC results : In appendix D.3 of the revised version we now show the results obtained with SCC on calcium traces of manually extracted ROIs from one of the datasets discussed in the paper . We also show , using traces extracted from the motif identified with LeMoNADe on the original dataset , that SCC and LeMoNADe find highly similar motifs on real data . Other generative models : As we mention in the related work section , a few deep generative models exist dealing with video data . However , to the best of our knowledge , none of these models is directly applicable to the task of detecting motifs with temporal structure in calcium imaging data . Indeed , Johnson et al.present an interesting generative model for the analysis of video data . However , we consider this model as not being able to identify motifs with temporal structure from calcium imaging data due to two limitations ( for the detection of motifs in calcium videos ) of the model by Johnson et al . : 1.Neuronal assemblies are expected to extend over multiple frames ( depending on the frame rate of the recording this could be easily more than 20 frames ) . Since in Johnson et al . 's model the underlying latent process is a relatively simple first-order Markovian ( switching ) linear process , representing longer-term temporal dependencies will be very hard to achieve due to the usually exponential forgetting in such systems . In fact , Johnson et al . 's framework would need to be significantly extended , e.g.using LSTM units , to adapt their model for this task , which is a non-trivial task and could be considered to be a paper in its own right . 2.In the model of Johnson et al.each frame is generated from exactly one of K latent states . For calcium imaging , however , most frames are not generated by one of the motifs but from noise . While LeMoNADe has the chance to set the latent variables for noise frames simply to zero , Johnson et al . 's model would have to choose one motif as responsible for the frame even if it contains only noise . Moreover , LeMoNADe has the flexibility to also allow the different motifs to temporally overlap . This is also not possible in the model by Johnson et al. , since they allow always only exactly one latent state for each frame . For this reason , we can not compare to Johnson et al.on the task of detecting motifs in calcium imaging data . In the revised version of the manuscript we extended our citation of Johnson et al.with a short explanation why the model is not directly applicable to our setup of motif detection from calcium imaging data . The application is limited to calcium imaging data : The model and network architectures are indeed optimised for the task of detecting motifs in calcium imaging data . This is , however , no downside of the method . Calcium imaging is a method of first importance in neurophysiology . It allows the concurrent monitoring of the individual actions of thousands of neurons at the same time . As explained above , no other method is directly applicable to finding temporal motifs in calcium imaging data and in order to do so we had to adapt our method to the special properties of calcium imaging and neuronal assemblies . Nevertheless , our approach could also be adapted for detecting spatio-temporal motifs in data from other imaging techniques , such as voltage-sensitive dyes or functional magnetic resonance imaging ( fMRI ) ."}, "1": {"review_id": "SkloDjAqYm-1", "review_text": "Thank you for a pleasurable and informative read, I consider the writing and structure of the paper to be coherent and well written. Given an end-to-end learning of neural motifs, a great deal of time can be avoided, reducing the several intermediary steps required to detect motifs from calcium imaging. This paper may very well improve researchers efficiency, in particular when working with calcium imaging. The question remain to what extent these ideas may be useful in other imaging modalities, i.e. fMRI. My main critique would be to be more explicit about why the VAE you propose, is superior to other models in the generative modelling domain.", "rating": "8: Top 50% of accepted papers, clear accept", "reply_text": "We are gratefull for AnonReviewer4 's extra effort in order to provide us with a third review . We also thank him/her for the positive comments and for considering our paper to be well written and structured , and improving researchers efficiency . We agree that the application to fMRI and other imaging modalities makes for interesting future work . We took the reviewers comment into account and added a remark in the revised version at the beginning of section 3 . The great benefit of this generative model in combination with the proposed VAE is the possibility to directly extract the temporal motifs and their activations and at the same time take into account the sparse nature of neuronal assemblies ."}, "2": {"review_id": "SkloDjAqYm-2", "review_text": "last time i had two comments: 1. the real data motifs did not look like what i'd expect motifs to look like. now that the authors have thresholded the real data motifs, they do look as i'd expect. 2. i'm not a fan of VAE, and believe that simpler optimization algorithms might be profitable. i acknowledge that SCC requires additional steps; i am not comparing to SCC. rather, i'm saying given your generative model, there are many strategies one could employ to estimate the motifs. i realize that VAE is all the rage, and is probably fine. in my own experiments, simpler methods often work as well or better for these types of problems. i therefore believe this would be an interesting avenue to explore in future work.", "rating": "8: Top 50% of accepted papers, clear accept", "reply_text": "We kindly thank the reviewer for his/her positive feedback . We would appreciate it if you could state again - as you did in your last review - why the problem we address is an important one and why quote `` having an end-to-end procedure to learn motifs would be awesome '' . : ) Of course there are different approaches in general to infer generative models . However , given our particular generative model our approach to do inference via VI in the form of a VAE is rather intuitive and stable compared to e.g.sampling based approaches which are computationally more expensive or EM based approaches which are usually less flexible . So we are not using VAEs just because they are all the rage right now ( then we would use a GAN anyway ; ) ) . Nevertheless , we will of course continue doing research on this topic and will also investigate other approaches in future work ."}}