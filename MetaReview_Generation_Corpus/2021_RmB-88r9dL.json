{"year": "2021", "forum": "RmB-88r9dL", "title": "VCNet and Functional Targeted Regularization For Learning Causal Effects of Continuous Treatments", "decision": "Accept (Oral)", "meta_review": "The paper designs a new way (in some sense a new perspective) on how neural networks can be used to model intervention variables when the goal is to estimate ADRF.  Basically, the idea is to emphasize the importance of the intervention variable by ensuring that it appears not just in every layer but also in every neural of a neural network.  \n\nReviewers mostly agree that this is a good paper with varying degrees, although there are some criticisms on e.g., assuming away the confounders.  However, I believe the authors address the criticisms of R4 satisfactorily. \n\nOverall I find the idea new and interesting and the experimental results strong, hence I happily recommend accepting the paper.\n\nI do have a few quips myself and some comments that may help the authors to further improve the paper.\n\n1. Re: the design that models each parameter as a spline. \nThis is equivalent to introducing additional parameters (coefficients for spline basis) and adding a fixed linear layer (spline basis themselves) to every layer of the neural networks. t is taken as an input in all layers thus it makes sure that the model prioritizes on learning the impact of t. \n\n2. If you use a B-spline basis (that comes with kernels of bounded support), then the proposed method is very similar to stratifying the data according to different bins of t, and then fitting a separate model for each t. The only difference is that the different bins are now smooth kernels and they overlap somewhat. As a side note,  the authors should clearly write out how they are choosing the knots to specify the basis functions. Otherwise the paper will not be reproducible. \n\n3. I am not sure how this method would compare to naive (non-deep) baselines. Maybe this was considered in a prior work? If not, then I tend to side with Reviewer 4 that the evaluations are mostly ablation studies and they are not really comparing to representative work in this domain. Given that there is a large body of work on this before deep learning takes over, it is important to somehow compare with the right baselines.\n\n", "reviews": [{"review_id": "RmB-88r9dL-0", "review_text": "This paper is to develop a varying coefficient neural network to estimate average dose-response curve ( ADRF ) . Although this paper has several interesting results , the paper is full of many typos and small errors . The current paper needs substantial improvement . Here are some detailed comments . 1.The introduction section is not well written since the logic does not flow very smooth . 2.The motivation for \uff081\uff09can be improved . You miss period in ( 1 ) . 3.In Theorem 2 , please not use ( 1 ) - ( 6 ) to itemize the assumptions , since you use them to denote the equations . 4.In the proof of all theorems , there are some obvious mistakes inside .", "rating": "6: Marginally above acceptance threshold", "reply_text": "We thank the reviewer for the constructive feedback . We uploaded a revision of the manuscript , in which we make efforts to address your concerns : * We reorganize the introduction to make the logic flow more smoothly . * We add a sentence to explain the motivation of using loss ( 1 ) in section 3.3 of the revision . Notice that this loss is also used in [ 1 ] . * We change the index of assumptions in Theorem 2 . * We also checked the proofs thoroughly and corrected several typos and improved the presentation of the proofs . We would appreciate it if you could check and point out any remaining bugs , if any . * * Reference * * [ 1 ] Claudia Shi , David Blei , and Victor Veitch . Adapting neural networks for the estimation of treatment effects . In Advances in Neural Information Processing Systems , pp . 2503\u20132513 , 2019 ."}, {"review_id": "RmB-88r9dL-1", "review_text": "This problem is well-motivated estimating dose-response is a challenging and practically important problem . The paper is extremely well written . It explained complex ( poor written ) ideas in the semiparametric literature clearly . The comparison against existing works is clear . The theory , as far as I can tell , is sound . It improves the existing results in targeted regularization and can be adapted to analyze one step TMLE . The experiment shows that the model outperforms existing benchmarks on the task it set out to do . My main suggestion to improve the paper is to use some datasets that actually have continuous treatment in evaluating the method . In particular , I would be interested in seeing an application of the methods on real-world datasets . That being said , while it will improve the paper , it 's probably asking too much for an 8-page conference submission . I believe the paper at its current state is sufficient for acceptance . I want to thank the authors for writing such an elegant paper . I really enjoyed reading it .", "rating": "9: Top 15% of accepted papers, strong accept", "reply_text": "We thank the reviewer for the encouraging and constructive comments . We tried searching for a suitable dataset with continuous treatment when doing the project . But the problem is that in the real world , it is hard ( probably impossible ) to obtain the true ADRF ( as we can \u2019 t observe the counterfactual result in observational study ) and thus we fail to find a real world dataset . Thus we follow the same experiment setting as previous work [ 1,2 ] in which we consider a semi-synthetic dataset . * * Reference * * [ 1 ] Claudia Shi , David Blei , and Victor Veitch . Adapting neural networks for the estimation of treatment effects . In Advances in Neural Information Processing Systems , pp . 2503\u20132513 , 2019 . [ 2 ] Patrick Schwab , Lorenz Linhardt , Stefan Bauer , Joachim M Buhmann , and Walter Karlen . Learning counter- factual representations for estimating individual dose-response curves . arXiv preprint arXiv:1902.00981 , 2019 ."}, {"review_id": "RmB-88r9dL-2", "review_text": "Solid theoretical results are provided to confirm the doubly robustness of the treatment estimator and outcome estimator . This paper is well-written , however , I still have some concerns about the contributions . 1.The author claimed that confounder is one challenge for treatment effect estimation . Some existing deep learning methods resort to balanced learning or reweighting . For the continuous treatment , how the proposed method addresses the confounder factors ? 2.Another big concern is the varing coefficient neural network . Why the VCnet designed to be dependent of treatment information ? The dependence is not theoretically discussed in this paper . 3.The experimental results are not convincing for me . Only two baselines are compared with the proposed method . Also the sufficient theoretical discussion is given which however is mainly about the doubly robust estimators . But the design of VCnet needs the numerical results to confirm its effectiveness for ADRF .", "rating": "5: Marginally below acceptance threshold", "reply_text": "We thank you for your constructive comments ! Below please find our response . We hope that our responses to your concerns will increase your enthusiasm for our paper . If you believe we haven \u2019 t addressed all your concerns , we look forward to further discussions with you . * * Q1 * * : The author claimed that confounder is one challenge for treatment effect estimation . Some existing deep learning methods resort to balanced learning or reweighting . For the continuous treatment , how the proposed method addresses the confounder factors ? * * A1 * * : First , we assume there are no unobserved confounders . Under assumption 1 , our method is based on the following expression of ADRF : $ \\psi ( t ) =\\mathbb { E } _ { \\boldsymbol { X } } [ \\mu ( \\boldsymbol { X } , t ) ] $ . Notice that the above expectation is taken with respect to the marginal distribution of $ X $ . This implies that a naive method to estimate ADRF is to obtain an estimator $ \\hat\\mu $ for $ \\mu ( \\boldsymbol { x } , t ) =E ( Y|\\boldsymbol { X } =\\boldsymbol { x } , T=t ) $ and then use $ \\hat\\psi ( t ) =1/n\\sum_ { i=1 } ^n\\hat\\mu ( \\boldsymbol { x } _i , t ) $ as the estimator for $ \\psi ( t ) $ . Here estimating $ \\mu=E ( Y|\\boldsymbol { X } , T ) $ does not require reweighting , which is also a common practice in previous literature , see , for example [ 1 , 2 ] . And since we are directly using the empirical marginal distribution of $ X $ ( to approximate the population marginal distribution of $ X $ ) , reweighting is also not needed . We refer Reviewer 1 to Section 2 and the first paragraph of Section 3 of the main text for more details . * * Q2 * * : Another big concern is the varying coefficient neural network . Why the VCNet designed to be dependent of treatment information ? The dependence is not theoretically discussed in this paper . * * A2 * * : We are not sure whether we correctly understand your concern on \u2018 Why the VCNet designed to be dependent on treatment information \u2019 . We believe you inquire why we make the parameters of the network depend on treatment . The treatment is an input to the network but it is put in a special position . The reason we make it special is to prevent it from being lost in high dimensional latent representations as discussed in [ 3 ] , which also motivates previous network structures such as [ 1 ] and [ 2 ] . Please note that , as discussed in the last paragraph of Section 3.1 in the main text , the previous structure can also be viewed as VCNet in which the parameters of the network also depend on the treatment . The difference with the proposed VCNet is that they use a suboptimal choice of spline basis , which breaks the continuity structure of ADRF . So if previous lines of work on network structure make sense , we believe the proposed VCNet should also do . In terms of a theoretical justification , as discussed in paragraph 3 of introduction and Fig 1 in the original version of the submission , we believe one theoretical advantage of VCNet is that it takes the continuity of ADRF into modeling and thus produces better estimators in practice . In terms of more comprehensive theoretical analysis on why architecture A is better than B , as far as we know , there are no mathematical tools to theoretically study it at the current stage . For example , there are various building blocks proposed in the CV and NLP area but current theoretical tools could not explain why a certain building block is better than another ."}], "0": {"review_id": "RmB-88r9dL-0", "review_text": "This paper is to develop a varying coefficient neural network to estimate average dose-response curve ( ADRF ) . Although this paper has several interesting results , the paper is full of many typos and small errors . The current paper needs substantial improvement . Here are some detailed comments . 1.The introduction section is not well written since the logic does not flow very smooth . 2.The motivation for \uff081\uff09can be improved . You miss period in ( 1 ) . 3.In Theorem 2 , please not use ( 1 ) - ( 6 ) to itemize the assumptions , since you use them to denote the equations . 4.In the proof of all theorems , there are some obvious mistakes inside .", "rating": "6: Marginally above acceptance threshold", "reply_text": "We thank the reviewer for the constructive feedback . We uploaded a revision of the manuscript , in which we make efforts to address your concerns : * We reorganize the introduction to make the logic flow more smoothly . * We add a sentence to explain the motivation of using loss ( 1 ) in section 3.3 of the revision . Notice that this loss is also used in [ 1 ] . * We change the index of assumptions in Theorem 2 . * We also checked the proofs thoroughly and corrected several typos and improved the presentation of the proofs . We would appreciate it if you could check and point out any remaining bugs , if any . * * Reference * * [ 1 ] Claudia Shi , David Blei , and Victor Veitch . Adapting neural networks for the estimation of treatment effects . In Advances in Neural Information Processing Systems , pp . 2503\u20132513 , 2019 ."}, "1": {"review_id": "RmB-88r9dL-1", "review_text": "This problem is well-motivated estimating dose-response is a challenging and practically important problem . The paper is extremely well written . It explained complex ( poor written ) ideas in the semiparametric literature clearly . The comparison against existing works is clear . The theory , as far as I can tell , is sound . It improves the existing results in targeted regularization and can be adapted to analyze one step TMLE . The experiment shows that the model outperforms existing benchmarks on the task it set out to do . My main suggestion to improve the paper is to use some datasets that actually have continuous treatment in evaluating the method . In particular , I would be interested in seeing an application of the methods on real-world datasets . That being said , while it will improve the paper , it 's probably asking too much for an 8-page conference submission . I believe the paper at its current state is sufficient for acceptance . I want to thank the authors for writing such an elegant paper . I really enjoyed reading it .", "rating": "9: Top 15% of accepted papers, strong accept", "reply_text": "We thank the reviewer for the encouraging and constructive comments . We tried searching for a suitable dataset with continuous treatment when doing the project . But the problem is that in the real world , it is hard ( probably impossible ) to obtain the true ADRF ( as we can \u2019 t observe the counterfactual result in observational study ) and thus we fail to find a real world dataset . Thus we follow the same experiment setting as previous work [ 1,2 ] in which we consider a semi-synthetic dataset . * * Reference * * [ 1 ] Claudia Shi , David Blei , and Victor Veitch . Adapting neural networks for the estimation of treatment effects . In Advances in Neural Information Processing Systems , pp . 2503\u20132513 , 2019 . [ 2 ] Patrick Schwab , Lorenz Linhardt , Stefan Bauer , Joachim M Buhmann , and Walter Karlen . Learning counter- factual representations for estimating individual dose-response curves . arXiv preprint arXiv:1902.00981 , 2019 ."}, "2": {"review_id": "RmB-88r9dL-2", "review_text": "Solid theoretical results are provided to confirm the doubly robustness of the treatment estimator and outcome estimator . This paper is well-written , however , I still have some concerns about the contributions . 1.The author claimed that confounder is one challenge for treatment effect estimation . Some existing deep learning methods resort to balanced learning or reweighting . For the continuous treatment , how the proposed method addresses the confounder factors ? 2.Another big concern is the varing coefficient neural network . Why the VCnet designed to be dependent of treatment information ? The dependence is not theoretically discussed in this paper . 3.The experimental results are not convincing for me . Only two baselines are compared with the proposed method . Also the sufficient theoretical discussion is given which however is mainly about the doubly robust estimators . But the design of VCnet needs the numerical results to confirm its effectiveness for ADRF .", "rating": "5: Marginally below acceptance threshold", "reply_text": "We thank you for your constructive comments ! Below please find our response . We hope that our responses to your concerns will increase your enthusiasm for our paper . If you believe we haven \u2019 t addressed all your concerns , we look forward to further discussions with you . * * Q1 * * : The author claimed that confounder is one challenge for treatment effect estimation . Some existing deep learning methods resort to balanced learning or reweighting . For the continuous treatment , how the proposed method addresses the confounder factors ? * * A1 * * : First , we assume there are no unobserved confounders . Under assumption 1 , our method is based on the following expression of ADRF : $ \\psi ( t ) =\\mathbb { E } _ { \\boldsymbol { X } } [ \\mu ( \\boldsymbol { X } , t ) ] $ . Notice that the above expectation is taken with respect to the marginal distribution of $ X $ . This implies that a naive method to estimate ADRF is to obtain an estimator $ \\hat\\mu $ for $ \\mu ( \\boldsymbol { x } , t ) =E ( Y|\\boldsymbol { X } =\\boldsymbol { x } , T=t ) $ and then use $ \\hat\\psi ( t ) =1/n\\sum_ { i=1 } ^n\\hat\\mu ( \\boldsymbol { x } _i , t ) $ as the estimator for $ \\psi ( t ) $ . Here estimating $ \\mu=E ( Y|\\boldsymbol { X } , T ) $ does not require reweighting , which is also a common practice in previous literature , see , for example [ 1 , 2 ] . And since we are directly using the empirical marginal distribution of $ X $ ( to approximate the population marginal distribution of $ X $ ) , reweighting is also not needed . We refer Reviewer 1 to Section 2 and the first paragraph of Section 3 of the main text for more details . * * Q2 * * : Another big concern is the varying coefficient neural network . Why the VCNet designed to be dependent of treatment information ? The dependence is not theoretically discussed in this paper . * * A2 * * : We are not sure whether we correctly understand your concern on \u2018 Why the VCNet designed to be dependent on treatment information \u2019 . We believe you inquire why we make the parameters of the network depend on treatment . The treatment is an input to the network but it is put in a special position . The reason we make it special is to prevent it from being lost in high dimensional latent representations as discussed in [ 3 ] , which also motivates previous network structures such as [ 1 ] and [ 2 ] . Please note that , as discussed in the last paragraph of Section 3.1 in the main text , the previous structure can also be viewed as VCNet in which the parameters of the network also depend on the treatment . The difference with the proposed VCNet is that they use a suboptimal choice of spline basis , which breaks the continuity structure of ADRF . So if previous lines of work on network structure make sense , we believe the proposed VCNet should also do . In terms of a theoretical justification , as discussed in paragraph 3 of introduction and Fig 1 in the original version of the submission , we believe one theoretical advantage of VCNet is that it takes the continuity of ADRF into modeling and thus produces better estimators in practice . In terms of more comprehensive theoretical analysis on why architecture A is better than B , as far as we know , there are no mathematical tools to theoretically study it at the current stage . For example , there are various building blocks proposed in the CV and NLP area but current theoretical tools could not explain why a certain building block is better than another ."}}